<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>讯息 - 来自测试号</title>
<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.0.0/styles/a11y-dark.min.css">
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.0.0/highlight.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/pako/1.0.9/pako_inflate.min.js"></script>
<style type="text/css">
code{font-family:Menlo,Monaco,Consolas,"Andale Mono","lucida console","Courier New",monospace;font-size:12px;line-height:1.5;word-wrap:normal;white-space:pre-wrap;}
</style>
</head>
<body style="background-color: #2b2b2b">
<pre><code class="markdown"></code></pre>
</body>
<script>
function base64ToUint8Array(base64String) {
    let padding = '='.repeat((4 - base64String.length % 4) % 4);
    let base64 = (base64String + padding)
        .replace(/\-/g, '+')
        .replace(/_/g, '/');
    let rawData = window.atob(base64);
    let outputArray = new Uint8Array(rawData.length);
    for (var i = 0; i < rawData.length; ++i) {
        outputArray[i] = rawData.charCodeAt(i);
    }
    return outputArray;
}

function html2Escape(sHtml) {
    return sHtml.replace(/[<>&"]/g,function(c){return {'<':'&lt;','>':'&gt;','&':'&amp;','"':'&quot;'}[c];});
}

var search=window.location.search.substring(1);
var msg='';
if(search.startsWith('.')){
    var tmp0=search.indexOf('.',1);
    if(tmp0>1&&tmp0<9){
        var tmp1=parseInt(search.substring(1,tmp0));
        var tmp2=search.substring(tmp0+1);
        if(tmp1==tmp2.length){
            var tmp3=base64ToUint8Array(tmp2);
            var tmp4 = pako.inflate(tmp3);
            var decoder = new TextDecoder();
            msg = decoder.decode(tmp4);
        }
    }
}else{
    msg=decodeURIComponent(search);
}

if(msg==''){
    msg='ERROR';
}
var block = document.getElementsByTagName("code")[0];
block.innerHTML=html2Escape(msg);
hljs.highlightBlock(block);
</script>
</html>
